
<!DOCTYPE html>
<!-- saved from url=(0033)http://raphaeljs.com/touches.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Raphaël · Drag-n-drop</title>
<link rel="stylesheet" href="./Rapwee_files/demo.css" type="text/css" media="screen">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon-precomposed" href="http://raphaeljs.com/Raphael.png">
<link rel="stylesheet" href="./Rapwee_files/demo-print.css" type="text/css" media="print">
<script src="./Rapwee_files/raphael.js"></script>
<script>
window.onload = function () {
  var R = Raphael(0, 0, "100%", "100%"),
  battery=R.image("battery1.png",0,150,195,389); 
  //battery.rotate(90);
  wiret=R.image("wire.png",400,0,500,60);
  wireb=R.image("wire.png",400,0,500,60);
 // var sop=0;
 redled=R.image("Red_LED.png",0,150,195,389);
                //redled.rotate(90);
                var blocks=[battery,wireb,wiret,redled];

                var top = [[]];
                var left = [[]];
                var bottom = [[]];
                var right=[[]];

                var start = function () {
                  this.ox = this.attr("x");
                  this.oy = this.attr("y");

                },
                leftTerminal=function(blockB)
                {   cx=blockB.left;
                  cy=(blockB.top+blockB.bottom)/2;
                     /*   R.circle(cx,cy,10); //horizontal left center
                        R.circle(cx+20,cy+20,10);// horizontal left bottom
                        R.circle(cx+20,cy-20,10);//horizontal left top */
                        /*left[0][0]=cx;
                        left[0][1]=cy;
                        left[1][0]=cx+20;
                        left[1][1]=cy+20;
                        left[2][0]=cx+20;
                        left[2][1]=cy-20;
                        left[3][0]=cx+40/3;
                        left[3][1]=cy;*/
                        left=[[cx,cy],[cx+20,cy+20],[cx+20,cy-20],[cx+40/3,cy]];


                      }, 
                      rightTerminal=function(blockB)
                      {   cx=blockB.right;
                        cy=(blockB.top+blockB.bottom)/2;

                    /*    R.circle(cx,cy,10); //horizontal left center
                        R.circle(cx-20,cy-20,10);// horizontal left bottom
                        R.circle(cx-20,cy+20,10);//horizontal left top */
                        /*right[0][0]=cx;
                        right[0][1]=cy;
                        right[1][0]=cx-20;
                        right[1][1]=cy-20;
                        right[2][0]=cx-20;
                        right[2][1]=cy+20;
                        right[3][0]=cx-40/3;
                        right[3][1]=cy;*/
                        right=[[cx,cy],[cx-20,cy-20],[cx-20,cy+20],[cx-40/3,cy]];

                      }, 

                      topTerminal=function(blockB)
                      {
                        var w2=blockB;
                        w2cy=(w2.top+w2.bottom)/4;
                        w2cx=(w2.right+w2.left)/2;
                        w1cx=(w2.right+w2.left)/2;
                        w1cy=(w2.bottom);
                      /*R.circle(w2cx,w2.top,10);//circle top
                      R.circle(w2cx-20,w2.top+20,10);//circle top left
                      R.circle(w2cx+20,w2.top+20,10);//circle top right */
/*
                      top[0][0]=w2cx;
                      top[0][1]=w2.top;
                      top[1][0]=w2cx-20;
                      top[1][1]=w2.top+20;
                      top[2][0]=w2cx+20;
                      top[2][1]=w2.top+20;
                      top[3][0]=w2cx;
                      top[3][1]=w2.top+40/3; */
                      top=[[w2cx,w2.top],[w2cx-20,w2.top+20],[w2cx+20,w2.top+20],[w2cx,w2.top+40/3]];

                    },
                    bottomTerminal=function(blockB)
                    {
                      var w2=blockB;

                      w2cy=(w2.top+w2.bottom)/4;
                      w2cx=(w2.right+w2.left)/2;
                      w1cx=(w2.right+w2.left)/2;
                      w1cy=(w2.bottom);
/*                        R.circle(w2cx,w1cy,10);//circle bottom
  R.circle(w2cx+20,w2.bottom-20,10);//circle bottom right
  R.circle(w2cx-20,w2.bottom-20,10);//circle bottom left */
/*
  bottom[0][0]=w2cx;
  bottom[0][1]=w1cy;
  bottom[1][0]=w2cx+20;
  bottom[1][1]=w1cy-20;
  bottom[2][0]=w2cx-20;
  bottom[2][1]=w1cy-20;
  bottom[3][0]=w2cx;
  bottom[3][1]=w1cy-40/3;*/

  bottom=[[w2cx,w1cy],[w2cx+20,w1cy-20],[w2cx-20,w1cy-20],[w2cx,w1cy-40/3]];


},
move = function (dx, dy) {
  var current_Block=this.node.getBoundingClientRect();
  var blockA=this;
  if(current_Block.height>current_Block.width)
  {
    topTerminal(current_Block);
    bottomTerminal(current_Block);
    var top_centroid_x=top[3][0];
    var top_centroid_y=top[3][1];
    var bottom_centroid_x=bottom[3][0];
    var bottom_centroid_y=bottom[3][1];
  }
  else
  {
    leftTerminal(current_Block);
    rightTerminal(current_Block);
    var left_centroid_x=left[3][0];
    var left_centroid_y=left[3][1];
    var right_centroid_x=right[3][0];
    var right_centroid_y=right[3][1];

  }

  for(var i=0;i<blocks.length;i++)
  {
    if(blocks[i]!==blockA)
    {
      var blockB=blocks[i].node.getBoundingClientRect();
     if(blockB.height>blockB.width)//vertical
     {
      moveVertical(blockA,blocks[i],left_centroid_x,left_centroid_y,right_centroid_x,right_centroid_y,dx,dy);
}//vertical close
else
  { moveHorizontalBlock(blockA,blocks[i],top_centroid_x,top_centroid_y,bottom_centroid_x,bottom_centroid_y,dx,dy);
}//horizontally close
}
else{
  continue;
}
}
},

moveVertical = function(this1,blockB,left_centroid_x,left_centroid_y,right_centroid_x,right_centroid_y,dx,dy)
{


  var xxx=this1.node.getBoundingClientRect();
  var w2=blockB.node.getBoundingClientRect();
  w2cx=(w2.right+w2.left)/2;


  var distance_from_top_right_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx+20)),2)+Math.pow((left_centroid_y-(w2.top+20)),2));
  var distance_from_top_left_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx-20)),2)+Math.pow((left_centroid_y-(w2.top+20)),2));
  var distance_from_top_top_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx)),2)+Math.pow((left_centroid_y-w2.top),2));

  var distance_from_bottom_right_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx+20)),2)+Math.pow((left_centroid_y-(w2.bottom-20)),2));
  var distance_from_bottom_left_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx-20)),2)+Math.pow((left_centroid_y-(w2.bottom-20)),2));
  var distance_from_bottom_bottom_l=Math.sqrt(Math.pow((left_centroid_x-(w2cx)),2)+Math.pow((left_centroid_y-w2.bottom),2));

  var distance_from_top_right_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx+20)),2)+Math.pow((right_centroid_y-(w2.top+20)),2));
  var distance_from_top_left_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx-20)),2)+Math.pow((right_centroid_y-(w2.top+20)),2));
  var distance_from_top_top_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx)),2)+Math.pow((right_centroid_y-w2.top),2));

  var distance_from_bottom_right_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx+20)),2)+Math.pow((right_centroid_y-(w2.bottom-20)),2));
  var distance_from_bottom_left_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx-20)),2)+Math.pow((right_centroid_y-(w2.bottom-20)),2));
  var distance_from_bottom_bottom_r=Math.sqrt(Math.pow((right_centroid_x-(w2cx)),2)+Math.pow((right_centroid_y-w2.bottom),2));

  myArray=[distance_from_top_right_l,distance_from_top_left_l,distance_from_top_top_l,distance_from_bottom_right_l,distance_from_bottom_left_l,distance_from_bottom_bottom_l,distance_from_top_right_r,distance_from_top_left_r,distance_from_top_top_r,distance_from_bottom_right_r,distance_from_bottom_left_r,distance_from_bottom_bottom_r];
    //var min=checkMinimum(myArray);
    var id=myArray.indexOf(Math.min.apply(Math, myArray));
    var ccx=Math.min.apply(Math,myArray)-10;
    if((Math.min.apply(Math,myArray)<40 && Math.min.apply(Math,myArray)>0)){
     var current_Blockly=this1.node.getBoundingClientRect();

     switch(id){
      case 0:  
      if(current_Blockly.left-(w2cx+20)>0)
      {

        this1.animate({transform: 't'+(-ccx)+',0'},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }
      break;

      case 1:
      break;

      case 2: {




       if((left_centroid_y+20)-(w2.top)<0)
       {
        this1.animate({transform: 't0,'+(ccx)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }




    }
    break;

    case 3:
    if(current_Blockly.left-(w2cx+20)>0)
    {
      this1.animate({transform: 't'+(-ccx)+',0'},500);

      up(this1);
    }
    else
    {

      this1.attr({x: this1.ox + dx, y: this1.oy + dy});


    }
    break;

    case 4:
    break;

    case 5:
    if((left_centroid_y-20)-w2.bottom>0)
    {
      this1.animate({transform: 't0,'+(-ccx)},500);

      up(this1);
    }
    else
    {

      this1.attr({x: this1.ox + dx, y: this1.oy + dy});


    }

    break;

    case 6:
    break;

    case 7:

    if((w2cx-20)-current_Blockly.right>0)
    {
      this1.animate({transform: 't'+(ccx)+',0'},500);

      up(this1);
    }
    else
    {

      this1.attr({x: this1.ox + dx, y: this1.oy + dy});


    }

    break;

    case 8:

    if(w2.top-(right_centroid_y+20)>0)
    {
      this1.animate({transform: 't0,'+ccx},500);

      up(this1);
    }
    else
    {

      this1.attr({x: this1.ox + dx, y: this1.oy + dy});


    }





    break;

    case 9:
    break;

    case 10:

    if((w2cx-20)-current_Blockly.right>0)
    {
      this1.animate({transform: 't'+(ccx)+',0'},500);

      up(this1);
    }
    else
    {

      this1.attr({x: this1.ox + dx, y: this1.oy + dy});


    }





    break;

      case 11://this1.animate({transform: 't0,-40'},500);
       //this1.animate({transform: 't0,40'},500);
       if((right_centroid_y-20)-(w2.bottom)>0)
       {
        this1.animate({transform: 't0,'+(-cxx)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }



      break;
    };


  }

  else
  {
    this1.attr({x: this1.ox + dx, y: this1.oy + dy});


  }






},





moveHorizontalBlock = function(this1,blockB,top_centroid_x,top_centroid_y,bottom_centroid_x,bottom_centroid_y,dx,dy){


  var w2=blockB.node.getBoundingClientRect();
  thiscx=w2.left;
  thiscy=(w2.top+w2.bottom)/2;

  var distance_from_left_bottom_t=Math.sqrt(Math.pow((top_centroid_x-(w2.left+20)),2)+Math.pow((top_centroid_y-(thiscy+20)),2));
  var distance_from_left_top_t=Math.sqrt(Math.pow((top_centroid_x-(w2.left+20)),2)+Math.pow((top_centroid_y-(thiscy-20)),2));
  var distance_from_left_left_t=Math.sqrt(Math.pow((top_centroid_x-(w2.left)),2)+Math.pow((top_centroid_y-thiscy),2));

  var distance_from_right_bottom_t=Math.sqrt(Math.pow((top_centroid_x-(w2.right-20)),2)+Math.pow((top_centroid_y-(thiscy+20)),2));
  var distance_from_right_top_t=Math.sqrt(Math.pow((top_centroid_x-(w2.right-20)),2)+Math.pow((top_centroid_y-(thiscy-20)),2));
  var distance_from_right_right_t=Math.sqrt(Math.pow((top_centroid_x-(w2.right)),2)+Math.pow((top_centroid_y-thiscy),2));


  var distance_from_left_bottom_b=Math.sqrt(Math.pow((bottom_centroid_x-(thiscx+20)),2)+Math.pow((bottom_centroid_y-(thiscy+20)),2));
  var distance_from_left_top_b=Math.sqrt(Math.pow((bottom_centroid_x-(thiscx+20)),2)+Math.pow((bottom_centroid_y-(thiscy-20)),2));
  var distance_from_left_left_b=Math.sqrt(Math.pow((bottom_centroid_x-(thiscx)),2)+Math.pow((bottom_centroid_y-thiscy),2));

  var distance_from_right_bottom_b=Math.sqrt(Math.pow((bottom_centroid_x-(w2.right-20)),2)+Math.pow((bottom_centroid_y-(thiscy+20)),2));
  var distance_from_right_top_b=Math.sqrt(Math.pow((bottom_centroid_x-(w2.right-20)),2)+Math.pow((bottom_centroid_y-(thiscy-20)),2));
  var distance_from_right_right_b=Math.sqrt(Math.pow((bottom_centroid_x-(w2.right)),2)+Math.pow((bottom_centroid_y-thiscy),2));


  var myArray=[distance_from_left_bottom_t,distance_from_left_bottom_b,distance_from_left_top_b,distance_from_left_top_t,distance_from_left_left_b,distance_from_left_left_t,distance_from_right_bottom_b,distance_from_right_bottom_t,distance_from_right_top_b,distance_from_right_top_t,distance_from_right_right_b,distance_from_right_right_t];

  var id=myArray.indexOf(Math.min.apply(Math, myArray));


  var ccy=Math.min.apply(Math,myArray)-10;
  if(Math.min.apply(Math,myArray)<40&&Math.min.apply(Math,myArray)>0){

    switch(id){
      case 0: //this1.animate({transform: 't0,-40'},500);

      if((top_centroid_y-20)-(thiscy+20)>0)
      {

        this1.animate({transform: 't0,'+(-ccy)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }


      break;

      case 1: //this1.animate({transform: 't0,0'},500);//
      break;

      case 2: //this1.animate({transform: 't0,40'},500);
      
      if((thiscy-20)-(bottom_centroid_y+20)>0)
      {

        this1.animate({transform: 't0,'+(ccy)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }





      break;

      case 3://this1.animate({transform: 't0,0'},500);
      break;

      case 4:

      if(w2.left-(bottom_centroid_x+20)>0)
      {

        this1.animate({transform: 't'+(ccy)+',0'},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }



      //this1.animate({transform: 't40,0'},500);
      break;

      case 5://this1.animate({transform: 't40,0'},500);
      
      if(w2.left-(top_centroid_x+20)>0)
      {

        this1.animate({transform: 't'+(ccy)+',0'},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }






      break;

      case 6://this1.animate({transform: 't0,0'},500);
      break;

      case 7://this1.animate({transform: 't0,-40'},500);
      if((top_centroid_y-20)-(thiscy+20)>0)
      {

        this1.animate({transform: 't0,'+(-ccy)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }




      break;

      case 8://this1.animate({transform: 't0,40'},500);
      
      if((thiscy-20)-(bottom_centroid_y+20)>0)
      {

        this1.animate({transform: 't0,'+(ccy)},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }





      break;

      case 9://this1.animate({transform: 't0,0'},500);
      break;

      case 10://this1.animate({transform: 't-40,0'},500);

      if((bottom_centroid_x-20)-(w2.right)>0)
      {

        this1.animate({transform: 't'+(-ccy)+',0'},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }


      break;

      case 11://this1.animate({transform: 't-40,0'},500);

      if((top_centroid_x-20)-(w2.right)>0)
      {

        this1.animate({transform: 't'+(-ccy)+',0'},500);

        up(this1);
      }
      else
      {

        this1.attr({x: this1.ox + dx, y: this1.oy + dy});


      }



      break;
    };
  }
  else
  {
   

    this1.attr({x: this1.ox+ dx, y:this1.oy+dy });

  }






},




up = function (block) {
  block.undrag();
  block.drag(move,start);
};



battery.drag(move, start);
wiret.drag(move,start);
wireb.drag(move,start);
redled.drag(move,start);
};
</script>
</head>
<body>
  <div id="holder"></div>

  <svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: absolute; left: 0px; top: 0px;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.2</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></defs></svg></body></html>
